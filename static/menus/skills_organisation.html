<section id="view-votre-organisation" style="display:none;">
  <div class="card">
    <div class="card-title">Votre organisation</div>
    <div class="card-sub">
      Sélectionnez un service pour afficher la cartographie des postes et la fiche de poste associée.
    </div>
  </div>

  <div class="sb-split">
    <!-- Arbre services -->
    <div class="sb-col">
      <div class="card">
        <div class="card-title" style="margin-bottom:6px;">Services</div>
        <div class="card-sub" style="margin:0;">Cliquez sur un service.</div>

        <div class="sb-tree" id="orgTree">
          <div class="card-sub" style="margin-top:10px;">Chargement…</div>
        </div>
      </div>
    </div>

    <!-- Détails + postes -->
    <div class="sb-col">
      <div class="card">
        <div class="card-title" id="orgServiceTitle">Service non sélectionné</div>
        <div class="card-sub" id="orgServiceMeta" style="margin:0;">—</div>
      </div>

      <div class="card">
        <div style="display:flex; justify-content:space-between; align-items:flex-end; gap:12px; flex-wrap:wrap;">
          <div>
            <div class="card-title" style="margin-bottom:4px;">Postes</div>
            <div class="card-sub" style="margin:0;">Fiches de poste rattachées au service sélectionné.</div>
          </div>

          <div style="min-width:220px; flex:1;">
            <div class="label">Rechercher un poste</div>
            <input type="text" id="posteSearch" placeholder="Code ou intitulé…" />
          </div>
        </div>

        <div id="postesContainer" style="margin-top:12px;">
          <div class="card-sub">Sélectionnez un service pour afficher les postes.</div>
        </div>

        <div class="card-sub" id="postesEmpty" style="display:none; margin-top:10px;">
          Aucun poste pour ce service.
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ======================================================
     Modal Poste (Votre organisation) — Squelette 3 onglets
     ====================================================== -->
<div id="modalOrgPoste" class="modal" aria-hidden="true">
  <div class="modal-card">

    <div class="modal-header" style="align-items:flex-start;">
      <div style="display:flex; flex-direction:column; gap:10px; min-width:0; flex:1;">
        <div class="sb-modal-titleline">
          <span id="orgPosteModalBadge" class="sb-badge sb-badge-poste-code" style="display:none;"></span>
          <div id="orgPosteModalTitle" class="sb-title-text">Poste</div>
        </div>

        <div class="sb-segbar" id="orgPosteTabbar">
          <button type="button" class="sb-seg is-active" data-tab="def">Définition</button>
          <button type="button" class="sb-seg" data-tab="exi">Exigences</button>
          <button type="button" class="sb-seg" data-tab="rh">Paramétrage RH</button>
        </div>
      </div>

      <button type="button" class="modal-x" id="orgPosteModalX" aria-label="Fermer">×</button>
    </div>

    <div class="modal-body">
      <!-- Définition -->
      <div class="sb-tab-panel is-active" data-panel="def">
        <div class="card org-poste-def-card" style="padding:12px; margin:0;">
          <div class="org-poste-def-head">
            <div class="card-title" style="margin:0;">Définition du poste</div>
            <span id="orgPosteDefRespBadge" class="sb-badge sb-badge-resp" style="display:none;">Responsable</span>
          </div>

          <div id="orgPosteDefMissionWrap" class="sb-field" style="margin-top:10px; display:none;">
            <div class="label">Mission principale</div>
            <div id="orgPosteDefMission" class="value"></div>
          </div>

          <div id="orgPosteDefRespWrap" class="sb-field text-block" style="margin-top:10px; display:none;">
            <div class="label">Responsabilités</div>
            <div id="orgPosteDefResp" class="value sb-richtext"></div>
          </div>

          <div id="orgPosteDefEmpty" class="card-sub" style="margin-top:10px; display:none;">
            Aucune description renseignée.
          </div>

          <div id="orgPosteDefDate" class="org-poste-def-date" style="display:none;"></div>
        </div>
      </div>


      <!-- Exigences -->
      <div class="sb-tab-panel" data-panel="exi">
        <div class="card org-bloc" id="orgPosteBlocContraintes">
          <div class="card-title">Contraintes</div>

          <div class="org-form-grid">
            <div class="sb-field">
              <div class="label">Niveau d’étude minimum requis</div>
              <select id="orgCtrEduMin" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Domaine du diplôme (NSF)</div>
              <select id="orgCtrNsfGroupe" disabled></select>
            </div>

            <div class="sb-field org-span-2">
              <label class="sb-check">
                <input type="checkbox" id="orgCtrNsfOblig" disabled />
                <span>Correspondance du diplôme impérative</span>
              </label>
            </div>

            <div class="sb-field">
              <div class="label">Mobilité</div>
              <select id="orgCtrMobilite" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Risques physiques</div>
              <select id="orgCtrRisquePhys" disabled></select>
              <div class="sb-help" id="orgCtrRisquePhysHelp" style="display:none;"></div>
            </div>


            <div class="sb-field org-span-2">
              <div class="label">Perspectives d’évolution</div>
              <select id="orgCtrPerspEvol" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Niveau de contraintes</div>
              <select id="orgCtrNivContrainte" disabled></select>
              <div class="sb-help" id="orgCtrNivContrainteHelp" style="display:none;"></div>
            </div>


            <div class="sb-field org-span-2">
              <div class="label">Détails des contraintes</div>
              <textarea id="orgCtrDetailContrainte" rows="4" disabled></textarea>
            </div>
          </div>
        </div>


        <div class="card" style="padding:12px; margin:0;">
          <div class="card-title" style="margin-bottom:6px;">Compétences requises</div>

          <div class="table-wrap" style="margin-top:10px;">
            <table class="sb-table" id="orgPosteCompTable">
              <thead>
                <tr>
                  <th style="width:80px; text-align:center;">Code</th>
                  <th>Compétence</th>
                  <th style="width:90px;">Niveau requis</th>
                  <th style="width:80px; text-align:center;">Criticité</th>
                  <th style="width:40px;" class="col-center">Ind.</th>
                </tr>
              </thead>
              <tbody id="orgPosteCompTbody"></tbody>
            </table>
          </div>

          <div class="card-sub" id="orgPosteCompEmpty" style="display:none; margin-top:10px;">
            Aucune compétence requise pour ce poste.
          </div>
        </div>


        <div class="card" style="padding:12px; margin:0;">
          <div class="card-title" style="margin-bottom:6px;">Certifications requises</div>

          <div class="table-wrap" style="margin-top:10px;">
            <table class="sb-table" id="orgPosteCertTable">
              <thead>
                <tr>
                  <th>Certification</th>
                  <th style="width:160px;">Catégorie</th>
                  <th style="width:40px;" class="col-center">Ind.</th>
                </tr>
              </thead>
              <tbody id="orgPosteCertTbody"></tbody>
            </table>
          </div>

          <div class="card-sub" id="orgPosteCertEmpty" style="display:none; margin-top:10px;">
            Aucune certification requise pour ce poste.
          </div>
        </div>

      </div>

      <!-- Paramétrage RH -->
      <div class="sb-tab-panel" data-panel="rh">
        <div class="card org-bloc" id="orgPosteBlocRh">
          <div class="org-poste-rh-head">
            <div class="card-title" style="margin:0;">Paramétrage RH</div>

            <div class="org-poste-rh-actions">
              <span id="orgRhLockBadge" class="sb-badge sb-badge-rh-lock" style="display:none;">Modifié par le client</span>

              <div class="org-rh-btns">
                <button type="button" class="btn-secondary btn-rh-edit" id="orgRhBtnEdit">Modifier</button>
                <button type="button" class="btn-secondary btn-rh-save" id="orgRhBtnSave" style="display:none;">Enregistrer</button>
                <button type="button" class="btn-secondary btn-rh-cancel" id="orgRhBtnCancel" style="display:none;">Annuler</button>
              </div>
            </div>
          </div>

          <div class="org-form-grid org-rh-grid">
            <div class="sb-field">
              <div class="label">Statut du poste</div>
              <select id="orgRhStatut" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Criticité du poste</div>
              <select id="orgRhCriticite" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Stratégie de pourvoi</div>
              <select id="orgRhStrategie" disabled></select>
            </div>

            <div class="sb-field">
              <div class="label">Nb titulaires cible</div>
              <div class="sb-stepper" aria-label="Nb titulaires cible">
                <button type="button" class="sb-stepper-btn" id="orgRhNbMinus" disabled>-</button>
                <input id="orgRhNbTitulaires" type="number" min="0" step="1" disabled />
                <button type="button" class="sb-stepper-btn" id="orgRhNbPlus" disabled>+</button>
              </div>
            </div>

            <div class="sb-field">
              <div class="label">Début de validité</div>
              <input id="orgRhDateDebut" type="date" class="sb-date" disabled />
            </div>

            <div class="sb-field">
              <div class="label">Fin de validité</div>
              <input id="orgRhDateFin" type="date" class="sb-date" disabled />
            </div>

            <div class="sb-field">
              <div class="label">Source</div>
              <input id="orgRhSource" type="text" disabled />
            </div>

            <div class="sb-field">
              <div class="label">Dernière mise à jour</div>
              <input id="orgRhDateMaj" type="text" disabled />
            </div>

            <div class="sb-field org-span-2">
              <div class="label">Commentaire</div>
              <textarea id="orgRhCommentaire" rows="3" disabled></textarea>
            </div>
          </div>
        </div>
      </div>


    <div class="modal-footer">
      <button type="button" class="btn-secondary" id="orgPosteModalClose">Fermer</button>
    </div>

  </div>
</div>
